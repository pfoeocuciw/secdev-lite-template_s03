# S04 ‚Äî Risk Scoring (L√óI)

## üìù –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∏—Å–∫–æ–≤

| Risk ID | Source (DFD/Row)                      | Consolidated Description                                                                                                                                   | Threat | NFR link (ID)         | L (1‚Äì5) | Rationale-L                                                                                                    | I (1‚Äì5) | Rationale-I                                                                                               | Score (=L√óI) | Decision (Top-5?) | ADR candidate                  |
|---------|----------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|--------|-------------------------|---------|---------------------------------------------------------------------------------------------------------------|---------|----------------------------------------------------------------------------------------------------------|-------------|-------------------|---------------------------------|
| R-01    | Client ‚Üí API (public edge)            | –ü–æ–¥–¥–µ–ª–∫–∞/–∫—Ä–∞–∂–∞ JWT ‚Üí –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∑–∞–∫–∞–∑–∞–º/–ø–ª–∞—Ç–µ–∂–∞–º                                                                                          | S      | NFR-SEC-AUTHN          | 5       | –ü—É–±–ª–∏—á–Ω–∞—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ç–æ–∫–µ–Ω; –≤–æ–∑–º–æ–∂–µ–Ω —Ñ–∏—à–∏–Ω–≥/—É—Ç–µ—á–∫–∞                                               | 5       | –ü–æ–ª–Ω–∞—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è —É—á—ë—Ç–∫–∏ ‚Üí –¥–æ—Å—Ç—É–ø –∫ –∑–∞–∫–∞–∑–∞–º/PII                                                       | 25          | ‚úÖ Top-1          | JWT TTL+Refresh; Revocation      |
| R-02    | API ‚Üí OrdersSvc ‚Üí DB (OrderCreate)    | –û—à–∏–±–∫–∏ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏/–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∑–∞–∫–∞–∑–∞ ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ/–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤ –¥—Ä—É–≥–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏                                                                 | T/E    | NFR-SEC-AUTHZ, NFR-VAL | 4       | –¢–∏–ø–æ–≤–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –≤—ã–∑–æ–≤ –±–µ–∑ –¥–æ–ø. –≤–∞–ª–∏–¥–∞—Ü–∏–∏                                                  | 4       | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–∞—Å—Å–æ–≤–æ–π –ø–æ–¥–º–µ–Ω—ã/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤                                                        | 16          | ‚úÖ Top-2          | RBAC + Tenant Scoping + Validation |
| R-03    | API ‚Üî PayProvider (External call)     | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CircuitBreaker/Timeout ‚Üí –∑–∞–≤–∏—Å–∞–Ω–∏—è –∏–ª–∏ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ –ø—Ä–∏ —Å–±–æ—è—Ö –≤–Ω–µ—à–Ω–µ–≥–æ –ø–ª–∞—Ç—ë–∂–Ω–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞                                               | DoS    | NFR-TIMEOUTS, NFR-CB   | 4       | –í–Ω–µ—à–Ω—è—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å, —Ç–∏–ø–∏—á–Ω—ã–π —Å–±–æ–π–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π                                                              | 4       | –ú–∞—Å—Å–æ–≤—ã–π –ø—Ä–æ—Å—Ç–æ–π –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ (–≤—Å–µ –∫–ª–∏–µ–Ω—Ç—ã –Ω–µ –º–æ–≥—É—Ç –æ–ø–ª–∞—Ç–∏—Ç—å)                                      | 16          | ‚úÖ Top-3          | Circuit Breaker + Retries        |
| R-04    | PayProvider ‚Üí API (Webhook)          | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ HMAC / –∑–∞—â–∏—Ç—ã –æ—Ç replay ‚Üí –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –ø–æ–¥–¥–µ–ª–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–ª–∞—Ç–µ–∂–µ                                                           | S/T    | NFR-WEBHOOK-AUTH      | 4       | –í–µ–±—Ö—É–∫–∏ –ø—É–±–ª–∏—á–Ω—ã, —á–∞—Å—Ç–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é, –≤–æ–∑–º–æ–∂–Ω—ã –æ—à–∏–±–∫–∏                                             | 5       | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ñ–µ–π–∫–æ–≤—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π ‚Üí —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ—Ç–µ—Ä–∏/PII —É—Ç–µ—á–∫–∞                                           | 20          | ‚úÖ Top-4          | Webhook Auth (HMAC + Nonce)     |
| R-05    | OrdersSvc ‚Üí DB (PII storage)          | –£—Ç–µ—á–∫–∞/–∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è PII –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–∏ –∏–ª–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö                                                                | I      | NFR-PRIVACY-PII       | 3       | –î–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω, –Ω–æ —á–∞—Å—Ç–æ –ª–æ–≥–∏/–±—ç–∫–∞–ø—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç–æ                                                      | 5       | –ú–∞—Å—Å–æ–≤–∞—è —É—Ç–µ—á–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö ‚Üí —Ä–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–µ/—Ä–µ–ø—É—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è                              | 15          | ‚úÖ Top-5          | PII Encryption + Masking         |
| R-06    | API ‚Üí SearchSvc ‚Üí Index              | –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ –ª–∏–º–∏—Ç—ã/–≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –ø–æ–∏—Å–∫–æ–≤–æ–º API ‚Üí DoS —á–µ—Ä–µ–∑ –¥–ª–∏–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏–ª–∏ —Å–ª–æ–∂–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã                                                              | DoS    | NFR-LIMITS, NFR-PERF  | 3       | –ü—É–±–ª–∏—á–Ω–∞—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å, –Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –¥–ª–∏–Ω—É –º–æ–∂–Ω–æ –≤–≤–µ—Å—Ç–∏                                                 | 3       | –ó–∞–º–µ–¥–ª–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞, –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø–∞–¥–µ–Ω–∏—è —É–∑–ª–∞ –ø–æ–∏—Å–∫–∞                                                         | 9           | ‚ùå               | Query Length Limits + RateLimit |
| R-07    | Internal events (Q ‚Üî Email)          | –ü–æ—Ç–µ—Ä—è/–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –æ—á–µ—Ä–µ–¥–∏ ‚Üí –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Å—Ç–∞—Ç—É—Å–æ–≤ –∏–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π                                                                       | R/T    | NFR-RELIABILITY       | 2       | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—á–µ—Ä–µ–¥—å, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–∞—è —Å—Ä–µ–¥–∞                                                                   | 2       | –õ–æ–∫–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ                                                                  | 4           | ‚ùå               | DLQ + Retries                   |

---

## –°–≤–æ–¥–∫–∞ Top-5 —Ä–∏—Å–∫–æ–≤ (–¥–ª—è S05 / ADR)

- **Top-1 (R-01)** ‚Äî –ü–æ–¥–¥–µ–ª–∫–∞ JWT, L=5 I=5 Score=25 ‚Üí _ADR: JWT TTL + Refresh + Revocation_
- **Top-2 (R-02)** ‚Äî –û—à–∏–±–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏/–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–∞–∫–∞–∑–æ–≤, L=4 I=4 Score=16 ‚Üí _ADR: RBAC + Tenant Scoping_
- **Top-3 (R-04)** ‚Äî –ü–æ–¥–¥–µ–ª—å–Ω—ã–µ –≤–µ–±—Ö—É–∫–∏, L=4 I=5 Score=20 ‚Üí _ADR: Webhook Auth (HMAC + Replay Protection)_
- **Top-4 (R-03)** ‚Äî –ù–µ—Ç CircuitBreaker –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π, L=4 I=4 Score=16 ‚Üí _ADR: Circuit Breaker Pattern_
- **Top-5 (R-05)** ‚Äî –£—Ç–µ—á–∫–∞ PII, L=3 I=5 Score=15 ‚Üí _ADR: Encryption + Masking + Privacy Controls_

